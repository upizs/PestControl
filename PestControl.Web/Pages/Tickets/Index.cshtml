@page
@model PestControl.Web.Pages.Tickets.IndexModel
@{
}

<h2>All Tickets</h2>

@if (Model.Message != null)
{
    <div class="alert alert-info">
        @Model.Message
    </div>
}
@if (Model.Tickets.Any()) 
{ 
<table class="table">
    <thead>
        <tr>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().Id)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().Title)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().Description)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().Project)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().Priority)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().AssignedUser)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().Status)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().Type)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().SubmittedByUser)</th>
            <th scope="col">@Html.DisplayNameFor(model => model.Tickets.Single().DateCreated)</th>
            <th scope="col">Actions</th>
        </tr>

    </thead>
    <tbody>
        @foreach (var ticket in Model.Tickets)
        {
        <tr>
            <td scope="row">@ticket.Id</td>
            <td >@ticket.Title</td>
            <td>@ticket.Description</td>
            <td>@ticket.Project.Name</td>
            <td>@ticket.Priority</td>
            <td>
                @if (ticket.AssignedUser != null)
                    @ticket.AssignedUser.UserName                  
                else {<p>None</p> }
                    
            </td>
            <td> @ticket.Status </td>
            <td> @ticket.Type</td>
            <td> <!--ticket.SubmittedByUser--> <p>none</p></td>
            <td> @ticket.DateCreated.Date</td>

            <td>
                <a class="btn btn-info btn-sm"
                   asp-page="./AssignUser"
                   asp-route-ticketId="@ticket.Id">Assign User</a>
                <a class="btn btn-info btn-sm"
                   asp-page="./Details"
                   asp-route-ticketId="@ticket.Id">Details</a>
                <a class="btn btn-info btn-sm"
                   asp-page="./Edit"
                   asp-route-ticketId="@ticket.Id">Edit</a>
                <a class="btn btn-danger btn-sm"
                   asp-page="./Delete"
                   asp-route-ticketId="@ticket.Id">Delete</a>
                
            </td>
        </tr>
        }
    </tbody>
</table>
}

<a class="btn btn-primary"
   asp-page="./Create">Add Ticket</a>
